*, *::before, *::after {
  margin: 0; padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}
:root {
  --rose: #d4849e;
  --blush: #f0c0d0;
  --deep: #5c2336;
  --cream: #fdf6f0;
  --gold: #c4996a;
  --ink: #2a1520;
  --soft: #fce8ef;
  --white: #fffaf8;
}
html { scroll-behavior: smooth; -webkit-text-size-adjust: 100%; }
body {
  background: var(--cream);
  font-family: 'DM Sans', sans-serif;
  color: var(--ink);
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* ── PROGRESS ── */
#progress {
  position: fixed; top: 0; left: 0;
  height: 3px; width: 0%;
  background: linear-gradient(90deg, var(--rose), var(--gold), var(--rose));
  background-size: 200% 100%;
  z-index: 999;
  animation: shimmer 2.5s linear infinite;
  transition: width 0.15s linear;
}
@keyframes shimmer { 0%{background-position:200% center} 100%{background-position:-200% center} }

/* ── BLOOM OVERLAY ── */
#bloom {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 600;
  background: radial-gradient(ellipse at center, rgba(212,132,158,0.35) 0%, transparent 70%);
  opacity: 0;
  transition: opacity 0.4s ease;
}
#bloom.on { opacity: 1; }

/* ── INTRO ── */
#intro {
  position: fixed; inset: 0;
  background: var(--deep); z-index: 900;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  gap: 14px; padding: 40px 28px; text-align: center;
  transition: opacity 0.9s ease, transform 0.9s ease;
}
#intro.leaving { opacity: 0; transform: scale(1.04); pointer-events: none; }
.intro-petals { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
.intro-petal { position: absolute; animation: fallIntro linear infinite; opacity: 0; }
@keyframes fallIntro {
  0%  { transform: translateY(-30px) rotate(0deg); opacity: 0; }
  10% { opacity: 0.55; }
  90% { opacity: 0.25; }
  100%{ transform: translateY(110vh) rotate(380deg); opacity: 0; }
}
.intro-for {
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  font-size: 1.1rem; color: var(--blush); opacity: 0;
  animation: riseIn 0.9s 0.6s forwards;
}
.intro-name {
  font-family: 'Cormorant Garamond', serif; font-weight: 600;
  font-size: clamp(4.5rem, 20vw, 8rem); color: #fff;
  line-height: 0.95; letter-spacing: -0.02em;
  opacity: 0; animation: riseIn 0.9s 1.1s forwards;
}
.intro-date {
  font-size: 0.65rem; letter-spacing: 0.38em; text-transform: uppercase;
  color: rgba(255,255,255,0.3); opacity: 0; animation: riseIn 0.8s 1.6s forwards;
}
.intro-btn {
  margin-top: 40px; padding: 17px 48px; border-radius: 50px;
  border: 1.5px solid rgba(255,255,255,0.22);
  background: rgba(255,255,255,0.06); color: #fff;
  font-family: 'DM Sans', sans-serif; font-size: 0.78rem;
  letter-spacing: 0.22em; text-transform: uppercase; cursor: pointer;
  opacity: 0; animation: riseIn 0.8s 2.1s forwards;
  transition: background 0.3s, transform 0.15s; -webkit-appearance: none;
}
.intro-btn:active { transform: scale(0.96); }
@keyframes riseIn { from{opacity:0;transform:translateY(22px)} to{opacity:1;transform:translateY(0)} }

/* ── HERO ── */
#hero {
  min-height: 100svh; display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  padding: 80px 28px 100px; text-align: center; position: relative;
  background: linear-gradient(160deg, #fff5f8 0%, #fce8ef 55%, #fdf0e6 100%);
  overflow: hidden;
}
.hero-glow {
  position: absolute; border-radius: 50%; filter: blur(70px); pointer-events: none;
  transition: transform 0.1s ease;
}
.hg1 { width: 420px; height: 420px; top: -130px; left: -130px;
        background: radial-gradient(circle, rgba(212,132,158,0.22), transparent 70%); }
.hg2 { width: 320px; height: 320px; bottom: -80px; right: -80px;
        background: radial-gradient(circle, rgba(196,153,106,0.16), transparent 70%); }
.hero-eyebrow {
  font-size: 0.62rem; letter-spacing: 0.42em; text-transform: uppercase;
  color: var(--deep); opacity: 0; transform: translateY(14px);
  transition: all 0.7s ease; margin-bottom: 18px;
}
.hero-eyebrow.vis { opacity: 0.45; transform: translateY(0); }
.hero-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(3.8rem, 19vw, 9.5rem); font-weight: 300;
  color: var(--deep); line-height: 0.9;
  opacity: 0; transform: translateY(28px); transition: all 0.9s 0.15s ease;
}
.hero-title.vis { opacity: 1; transform: translateY(0); }
.hero-title em { font-style: italic; font-weight: 600; color: var(--rose); display: block; margin-top: 4px; }
.hero-name {
  font-family: 'Cormorant Garamond', serif; font-size: clamp(1.1rem, 5.5vw, 2.2rem);
  font-style: italic; color: var(--deep); margin-top: 22px;
  opacity: 0; transform: translateY(14px); transition: all 0.8s 0.35s ease;
}
.hero-name.vis { opacity: 0.6; transform: translateY(0); }
.hero-heart {
  margin-top: 32px; font-size: 2rem; opacity: 0; display: inline-block;
  transition: all 0.8s 0.55s ease; animation: hb 2s ease infinite;
}
.hero-heart.vis { opacity: 1; }
@keyframes hb { 0%,100%{transform:scale(1)} 15%{transform:scale(1.2)} 30%{transform:scale(1)} 45%{transform:scale(1.12)} }
.scroll-cue {
  position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
  display: flex; flex-direction: column; align-items: center; gap: 8px; opacity: 0.28;
}
.scroll-cue span { font-size: 0.58rem; letter-spacing: 0.28em; text-transform: uppercase; color: var(--deep); }
.scroll-line {
  width: 1px; height: 34px;
  background: linear-gradient(to bottom, var(--deep), transparent);
  animation: sp 2s ease infinite;
}
@keyframes sp { 0%,100%{opacity:0.3;transform:scaleY(1)} 50%{opacity:0.7;transform:scaleY(1.3)} }

/* ── COUNTER ── */
#counter {
  background: var(--deep); padding: 80px 20px;
  position: relative; overflow: hidden;
}
#counter::before {
  content: ''; position: absolute; inset: 0;
  background:
    radial-gradient(ellipse at 15% 55%, rgba(212,132,158,0.11) 0%, transparent 55%),
    radial-gradient(ellipse at 88% 20%, rgba(196,153,106,0.07) 0%, transparent 50%);
}
.counter-intro {
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  color: var(--blush); font-size: clamp(1rem, 4.2vw, 1.4rem);
  text-align: center; margin-bottom: 44px; line-height: 1.55; padding: 0 8px;
  opacity: 0; transform: translateY(18px); transition: all 0.8s ease; position: relative;
}
.counter-intro.vis { opacity: 0.88; transform: translateY(0); }
.counter-grid {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 10px; max-width: 420px; margin: 0 auto; position: relative;
}
.c-card {
  background: rgba(255,255,255,0.045); border: 1px solid rgba(212,132,158,0.18);
  border-radius: 16px; padding: 20px 10px; text-align: center;
  opacity: 0; transform: translateY(28px); transition: opacity 0.6s ease, transform 0.6s ease;
  position: relative; overflow: hidden;
}
.c-card::after {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(212,132,158,0.45), transparent);
}
.c-card.vis { opacity: 1; transform: translateY(0); }
.c-card.span3 { grid-column: span 3; }
.c-num {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(1.55rem, 6.5vw, 2.6rem); font-weight: 600; color: #fff;
  display: block; line-height: 1; transition: color 0.15s, transform 0.15s;
}
.c-num.tick { color: var(--blush); transform: scale(1.1); }
.c-lbl {
  font-size: 0.56rem; letter-spacing: 0.26em; text-transform: uppercase;
  color: var(--rose); margin-top: 7px; display: block; opacity: 0.82;
}
.counter-since {
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  color: rgba(255,255,255,0.22); text-align: center;
  font-size: 0.88rem; margin-top: 36px; padding: 0 16px; position: relative;
}

/* ── PHOTOS ── */
#photos { padding: 80px 20px; background: var(--cream); }
.sec-eyebrow {
  text-align: center; font-size: 0.6rem; letter-spacing: 0.42em;
  text-transform: uppercase; color: var(--deep); opacity: 0.38; margin-bottom: 9px;
}
.sec-title {
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  font-size: clamp(1.7rem, 8vw, 3.2rem); color: var(--deep);
  text-align: center; font-weight: 300; margin-bottom: 44px;
}
.mosaic {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 10px; max-width: 460px; margin: 0 auto;
}
.p-card {
  border-radius: 18px; overflow: hidden; position: relative;
  box-shadow: 0 6px 32px rgba(92,35,54,0.1); cursor: pointer;
  opacity: 0; transform: translateY(28px) scale(0.97);
  transition: opacity 0.7s ease, transform 0.7s ease;
  will-change: transform;
}
.p-card.vis { opacity: 1; transform: translateY(0) scale(1); }
.p-card:nth-child(1) { aspect-ratio: 3/4; transition-delay: 0s; }
.p-card:nth-child(2) { aspect-ratio: 3/4; margin-top: 26px; transition-delay: 0.1s; }
.p-card:nth-child(3) { aspect-ratio: 4/3; grid-column: span 2; transition-delay: 0.2s; }
.p-card:nth-child(4) { aspect-ratio: 4/3; grid-column: span 2; transition-delay: 0.3s; }
.p-card img { width: 100%; height: 100%; object-fit: cover; display: block; }
.p-caption {
  position: absolute; bottom: 0; left: 0; right: 0;
  padding: 32px 14px 12px;
  background: linear-gradient(to top, rgba(92,35,54,0.62), transparent);
  color: rgba(255,255,255,0.92); font-family: 'Cormorant Garamond', serif;
  font-style: italic; font-size: 0.88rem; opacity: 0; transition: opacity 0.3s;
}
.p-card:active .p-caption { opacity: 1; }

/* ── LIGHTBOX ── */
#lightbox {
  position: fixed; inset: 0; background: rgba(6,1,4,0.96); z-index: 800;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  gap: 14px; padding: 20px; opacity: 0; pointer-events: none; transition: opacity 0.32s ease;
}
#lightbox.open { opacity: 1; pointer-events: all; }
#lightbox img {
  max-width: 100%; max-height: 80svh; border-radius: 14px; object-fit: contain;
  transform: scale(0.93); transition: transform 0.32s ease;
  box-shadow: 0 24px 80px rgba(0,0,0,0.65);
}
#lightbox.open img { transform: scale(1); }
#lb-close {
  background: rgba(255,255,255,0.1); border: none; color: #fff;
  width: 46px; height: 46px; border-radius: 50%; font-size: 1rem; cursor: pointer;
}

/* ════════════════════════════════
   ENVELOPE + CARTA IMERSIVA
════════════════════════════════ */
#carta-section {
  padding: 80px 0 100px;
  background: linear-gradient(180deg, #1a0810 0%, #0e0508 100%);
  position: relative; overflow: hidden; min-height: 100svh;
}

/* partículas de fundo */
#carta-section .particles { position: absolute; inset: 0; pointer-events: none; overflow: hidden; }
.particle {
  position: absolute; border-radius: 50%;
  background: rgba(212,132,158,0.4);
  animation: floatParticle linear infinite;
}
@keyframes floatParticle {
  0%  { transform: translateY(100vh) translateX(0) scale(0); opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 0.4; }
  100%{ transform: translateY(-10vh) translateX(var(--dx)) scale(1); opacity: 0; }
}

.carta-wrap {
  max-width: 540px; margin: 0 auto; padding: 0 18px;
  display: flex; flex-direction: column; align-items: center;
}

/* ── ENVELOPE ── */
#envelope-stage {
  width: 100%; max-width: 340px;
  margin: 0 auto 50px;
  opacity: 0; transform: translateY(40px);
  transition: opacity 0.9s ease, transform 0.9s ease;
}
#envelope-stage.vis { opacity: 1; transform: translateY(0); }

.envelope {
  position: relative; width: 100%;
  padding-bottom: 68%; /* aspect ratio */
  cursor: pointer; user-select: none;
}
.env-body {
  position: absolute; inset: 0;
  background: linear-gradient(160deg, #2a0f1a 0%, #1e0c14 100%);
  border-radius: 8px;
  border: 1px solid rgba(212,132,158,0.25);
  box-shadow: 0 20px 80px rgba(212,132,158,0.12), 0 0 0 1px rgba(212,132,158,0.08);
  overflow: hidden;
}
/* chevron bottom lines */
.env-body::before {
  content: '';
  position: absolute; bottom: 0; left: 0; right: 0;
  height: 50%;
  background:
    linear-gradient(135deg, #1e0c14 50%, transparent 50%),
    linear-gradient(225deg, #1e0c14 50%, transparent 50%);
  background-size: 50% 100%;
  background-position: left, right;
  background-repeat: no-repeat;
  opacity: 0.6;
}
.env-flap {
  position: absolute; top: 0; left: 0; right: 0;
  height: 52%;
  background: linear-gradient(170deg, #3d1525 0%, #2a0f1a 100%);
  clip-path: polygon(0 0, 100% 0, 50% 100%);
  transform-origin: top center;
  transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  border-bottom: 1px solid rgba(212,132,158,0.15);
  z-index: 2;
}
.envelope.open .env-flap {
  transform: rotateX(180deg);
}

/* Selo de cera */
.env-seal {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 52px; height: 52px;
  background: radial-gradient(circle at 35% 35%, #e8a0b4, #b05070);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.4rem;
  box-shadow: 0 4px 20px rgba(212,132,158,0.4), inset 0 1px 2px rgba(255,255,255,0.2);
  z-index: 3;
  transition: transform 0.4s ease, opacity 0.4s ease;
}
.envelope.open .env-seal {
  transform: translate(-50%, -50%) scale(0) rotate(180deg);
  opacity: 0;
}

/* brilho do envelope */
.env-glow {
  position: absolute; inset: -20px;
  background: radial-gradient(ellipse at center, rgba(212,132,158,0.08), transparent 65%);
  animation: envPulse 3s ease infinite;
  pointer-events: none;
}
@keyframes envPulse { 0%,100%{opacity:0.6} 50%{opacity:1} }

/* Hold button */
#hold-btn {
  position: relative; margin: 0 auto; display: block;
  width: 100%; max-width: 280px;
  background: none; border: 1.5px solid rgba(212,132,158,0.3);
  color: rgba(255,255,255,0.7); border-radius: 50px; padding: 16px 28px;
  font-family: 'DM Sans', sans-serif; font-size: 0.78rem;
  letter-spacing: 0.22em; text-transform: uppercase;
  cursor: pointer; overflow: hidden;
  transition: border-color 0.3s, color 0.3s;
  -webkit-appearance: none;
}
#hold-btn::before {
  content: '';
  position: absolute; top: 0; left: 0; bottom: 0;
  width: 0%;
  background: linear-gradient(90deg, rgba(212,132,158,0.25), rgba(212,132,158,0.1));
  transition: width 0.05s linear;
}
#hold-btn.holding::before { /* JS controls the width via style.setProperty */ }
#hold-btn.done {
  border-color: var(--rose);
  color: var(--rose);
  pointer-events: none;
}
#hold-btn .btn-text { position: relative; z-index: 1; }

/* instrução */
.env-hint {
  text-align: center; margin-top: 16px;
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  color: rgba(255,255,255,0.25); font-size: 0.82rem;
  transition: opacity 0.5s;
}
.env-hint.gone { opacity: 0; }

/* ── CARTA / LETTER ── */
#letter-reveal {
  width: 100%; opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}
#letter-reveal.vis { opacity: 1; transform: translateY(0); }

.letter-card {
  background: rgba(255,255,255,0.04);
  border-radius: 22px;
  padding: 34px 26px 38px;
  border: 1px solid rgba(212,132,158,0.12);
  position: relative;
}
.letter-card::before {
  content: ''; position: absolute; top: 0; left: 10%; right: 10%; height: 2.5px;
  background: linear-gradient(90deg, transparent, var(--rose), var(--gold), var(--rose), transparent);
  border-radius: 0 0 3px 3px;
}
.letter-to {
  font-family: 'Cormorant Garamond', serif; font-size: 1.35rem;
  font-weight: 600; color: rgba(255,255,255,0.9); margin-bottom: 22px;
}

/* cada parágrafo da carta */
.l-p {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(1.05rem, 4vw, 1.14rem);
  line-height: 1.95; color: rgba(255,230,236,0.85);
  font-weight: 300; margin-bottom: 20px;
  opacity: 0; transform: translateY(12px);
  transition: opacity 0.8s ease, transform 0.8s ease;
  min-height: 1em;
}
.l-p.vis { opacity: 1; transform: translateY(0); }
.l-p.emph { font-style: italic; color: rgba(240,192,208,0.95); }

/* cursor de digitação */
.l-p .cursor {
  display: inline-block; width: 2px; height: 1.1em;
  background: var(--rose); vertical-align: text-bottom;
  margin-left: 1px; animation: blink 0.9s ease infinite;
}
@keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }

/* Foto inline tipo Polaroid desenvolvendo */
.l-photo {
  margin: 28px -4px;
  border-radius: 16px; overflow: hidden;
  box-shadow: 0 8px 48px rgba(0,0,0,0.5), 0 0 0 1px rgba(212,132,158,0.15);
  opacity: 0;
  filter: brightness(0.3) saturate(0);
  transform: scale(0.94) translateY(20px);
  transition: opacity 1.2s ease, filter 1.6s ease, transform 1.2s ease;
  cursor: pointer; position: relative;
}
.l-photo.vis {
  opacity: 1; filter: brightness(1) saturate(1); transform: scale(1) translateY(0);
}
.l-photo img { width: 100%; display: block; max-height: 300px; object-fit: cover; }
.l-photo-note {
  background: rgba(10,2,6,0.85); padding: 9px 14px;
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  color: var(--blush); font-size: 0.82rem; text-align: center;
  backdrop-filter: blur(4px);
}

/* Assinatura */
.letter-sig {
  margin-top: 28px; padding-top: 22px;
  border-top: 1px solid rgba(212,132,158,0.16);
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  color: rgba(255,255,255,0.7); font-size: 1rem;
  opacity: 0; transform: translateY(12px); transition: all 0.8s ease;
}
.letter-sig.vis { opacity: 1; transform: translateY(0); }
.letter-sig strong { display: block; font-size: 1.2rem; font-style: normal; font-weight: 600; margin-top: 4px; color: var(--blush); }

/* ── FINAL ── */
#final {
  padding: 100px 24px 80px;
  background: linear-gradient(180deg, #0e0508 0%, var(--deep) 50%, #fdf0f4 100%);
  text-align: center;
}
.final-bloom { font-size: 3.8rem; display: block; margin-bottom: 22px; animation: hb 1.9s ease infinite; }
.final-quote {
  font-family: 'Cormorant Garamond', serif; font-style: italic;
  font-size: clamp(1.4rem, 6vw, 2.4rem); color: #fff;
  line-height: 1.35; max-width: 360px; margin: 0 auto 14px;
}
.final-sign { font-size: 0.72rem; letter-spacing: 0.22em; text-transform: uppercase; color: rgba(255,255,255,0.35); }

/* ── PLAYER ── */
#player {
  position: fixed; bottom: calc(env(safe-area-inset-bottom) + 16px); left: 50%;
  transform: translateX(-50%); z-index: 700;
  display: flex; align-items: center; gap: 10px;
  background: rgba(92,35,54,0.9); backdrop-filter: blur(24px);
  -webkit-backdrop-filter: blur(24px); border-radius: 50px;
  border: 1px solid rgba(255,255,255,0.09); padding: 5px 18px 5px 5px;
  box-shadow: 0 6px 36px rgba(92,35,54,0.38); max-width: calc(100vw - 32px);
}
#pbtn {
  width: 46px; height: 46px; border-radius: 50%; background: var(--rose); border: none;
  color: var(--deep); font-size: 1rem; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; transition: transform 0.15s;
}
#pbtn:active { transform: scale(0.9); }
.p-info { display: flex; flex-direction: column; gap: 1px; }
.p-title { color: #fff; font-size: 0.76rem; white-space: nowrap; }
.p-artist { color: var(--rose); font-size: 0.64rem; opacity: 0.85; white-space: nowrap; }
.waves { display: flex; align-items: center; gap: 2px; height: 16px; flex-shrink: 0; }
.waves b {
  display: block; width: 2.5px; background: var(--rose); border-radius: 2px;
  animation: wv 0.72s ease infinite;
}
.waves b:nth-child(1){animation-delay:0.0s}
.waves b:nth-child(2){animation-delay:0.1s}
.waves b:nth-child(3){animation-delay:0.2s}
.waves b:nth-child(4){animation-delay:0.12s}
.waves.off b { animation-play-state: paused; height: 3px !important; }
@keyframes wv { 0%,100%{height:3px} 50%{height:14px} }
